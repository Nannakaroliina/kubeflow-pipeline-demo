apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: kubeflow-pipeline-for-eddl-demo-
  annotations: {pipelines.kubeflow.org/kfp_sdk_version: 1.8.10, pipelines.kubeflow.org/pipeline_compilation_time: '2022-04-07T00:18:51.270231',
    pipelines.kubeflow.org/pipeline_spec: '{"description": "Kubeflow pipeline demo
      with simple EDDL model training", "name": "Kubeflow pipeline for EDDL demo"}'}
  labels: {pipelines.kubeflow.org/kfp_sdk_version: 1.8.10}
spec:
  entrypoint: kubeflow-pipeline-for-eddl-demo
  templates:
  - name: kubeflow-pipeline-for-eddl-demo
    dag:
      tasks:
      - name: test-model
        template: test-model
        dependencies: [train-model]
        arguments:
          artifacts:
          - {name: train-model-model, from: '{{tasks.train-model.outputs.artifacts.train-model-model}}'}
          - {name: train-model-x_test, from: '{{tasks.train-model.outputs.artifacts.train-model-x_test}}'}
          - {name: train-model-y_test, from: '{{tasks.train-model.outputs.artifacts.train-model-y_test}}'}
      - {name: train-model, template: train-model}
  - name: test-model
    container:
      args: [--model, /tmp/inputs/input-0/data, --x_test, /tmp/inputs/input-1/data,
        --y_test, /tmp/inputs/input-2/data]
      image: nannakaroliina/pyeddlpredict:latest
    inputs:
      artifacts:
      - {name: train-model-model, path: /tmp/inputs/input-0/data}
      - {name: train-model-x_test, path: /tmp/inputs/input-1/data}
      - {name: train-model-y_test, path: /tmp/inputs/input-2/data}
    metadata:
      labels:
        pipelines.kubeflow.org/kfp_sdk_version: 1.8.10
        pipelines.kubeflow.org/pipeline-sdk-type: kfp
        pipelines.kubeflow.org/enable_caching: "true"
  - name: train-model
    container: {image: 'nannakaroliina/pyeddltrain:latest'}
    outputs:
      artifacts:
      - {name: train-model-model, path: /app/net.bin}
      - {name: train-model-x_test, path: /app/mnist_tsX.bin}
      - {name: train-model-x_train, path: /app/mnist_trX.bin}
      - {name: train-model-y_test, path: /app/mnist_tsY.bin}
      - {name: train-model-y_train, path: /app/mnist_trY.bin}
    metadata:
      labels:
        pipelines.kubeflow.org/kfp_sdk_version: 1.8.10
        pipelines.kubeflow.org/pipeline-sdk-type: kfp
        pipelines.kubeflow.org/enable_caching: "true"
  arguments:
    parameters: []
  serviceAccountName: pipeline-runner
